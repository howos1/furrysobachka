<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YukiMeow Arts</title>
  <link rel="stylesheet" href="style-gallery.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
  <div class="container">
    <h1>YukiMeow Arts :3</h1>
    <div class="gallery" id="gallery"></div>
  </div>

  <div class="fullscreen-overlay" id="fullscreenOverlay">
    <button class="close-button" id="closeButton">
      <i class="fas fa-times"></i>
    </button>
    <img class="fullscreen-image" id="fullscreenImage" src="" alt="">
    <div class="fullscreen-author" id="fullscreenAuthor"></div>
  </div>

  <a href="index.html" class="back-button">
    <i class="fas fa-arrow-left"></i> Назад
  </a>

  <script>
    async function loadGallery() {
      try {
        const response = await fetch("https://meow.furrysobachka.ru/dist/yukimeow.json");
        const data = await response.json();

        const gallery = document.getElementById("gallery");
        const fullscreenOverlay = document.getElementById("fullscreenOverlay");
        const fullscreenImage = document.getElementById("fullscreenImage");
        const fullscreenAuthor = document.getElementById("fullscreenAuthor");
        const closeButton = document.getElementById("closeButton");

        data.forEach((item, index) => {
          setTimeout(() => {
            const div = document.createElement("div");
            div.className = "gallery-item";
            div.style.animationDelay = `${index * 0.1}s`;

            const wrapper = document.createElement("div");
            wrapper.className = "image-wrapper";

            const img = document.createElement("img");
            img.src = item.url;
            img.alt = `Рисунок от ${item.author}`;
            
            if (item.blur) {
              img.classList.add("blur-on-hover");
            }

            img.addEventListener("click", () => {
              openFullscreen(item.url, item.author);
            });

            const overlay = document.createElement("div");
            overlay.className = "author-overlay";
            overlay.textContent = `Автор: ${item.author}`;

            wrapper.appendChild(img);
            wrapper.appendChild(overlay);
            div.appendChild(wrapper);
            gallery.appendChild(div);
          }, index * 100);
        });

        function openFullscreen(imageUrl, author) {
          fullscreenImage.src = imageUrl;
          fullscreenAuthor.textContent = `Автор: ${author}`;
          fullscreenOverlay.classList.add('active');
          document.body.style.overflow = 'hidden';
        }

        function closeFullscreen() {
          fullscreenOverlay.classList.add('closing');
          setTimeout(() => {
            fullscreenOverlay.classList.remove('active', 'closing');
            document.body.style.overflow = 'auto';
          }, 400);
        }

        closeButton.addEventListener("click", closeFullscreen);
        fullscreenOverlay.addEventListener("click", (e) => {
          if (e.target === fullscreenOverlay) {
            closeFullscreen();
          }
        });

        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && fullscreenOverlay.classList.contains('active')) {
            closeFullscreen();
          }
        });

      } catch (err) {
        console.error("Ошибка загрузки галереи:", err);
        document.getElementById("gallery").innerHTML = "<p>Не удалось загрузить рисунки :(</p>";
      }
    }

    loadGallery();
  </script>
</body>
</html>
